
R version 3.5.1 (2018-07-02) -- "Feather Spray"
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin15.6.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(glmm)
Loading required package: trust
Loading required package: mvtnorm
Loading required package: Matrix
Loading required package: parallel
Loading required package: doParallel
Loading required package: foreach
Loading required package: iterators
> data(BoothHobert)
> clust <- makeCluster(2)
> set.seed(1234)
> out<-glmm(y~0+x1,list(y~0+z1),varcomps.names=c("z1"),data=BoothHobert,
+           family.glmm=bernoulli.glmm,m=50,doPQL=FALSE,debug=TRUE, cluster=clust)
> 
> vars <- new.env(parent = emptyenv())
> debug<-out$debug
> 
> vars$m1 <- debug$m1
> m2 <- debug$m2
> m3 <- debug$m3
> 
> vars$zeta <- 5
> 
> vars$cl <- clust
> registerDoParallel(vars$cl)                   #making cluster usable with foreach
> vars$no_cores <- length(vars$cl)
> 
> vars$mod.mcml<-out$mod.mcml
> 
> vars$nu.pql <- debug$nu.pql
> 
> getEk<-glmm:::getEk
> addVecs<-glmm:::addVecs
> genRand<-glmm:::genRand
> 
> nrand<-lapply(vars$mod.mcml$z,ncol)
> nrandom<-unlist(nrand)
> q<-sum(nrandom)
> totnrandom<-sum(nrandom)
> s.pql<-rep(0,totnrandom)
> if(q!=length(s.pql)) stop("Can't happen. Number of random effects returned by PQL must match number of random effects specified by model.")
> eek<-getEk(vars$mod.mcml$z)
> sigma.pql<-rep(1,length(vars$mod.mcml$z))
> #if any of the variance components are too close to 0, make them bigger:
> if(any(sigma.pql<10^-3)){
+   theseguys<-which(sigma.pql<10^-3)
+   sigma.pql[theseguys]<-10^-3
+ }
> Aks<-Map("*",eek,sigma.pql)
> A.star<-addVecs(Aks) #at this point still a vector
> vars$D.star<-A.star*A.star #still a vector
> vars$u.star<-A.star*s.pql 
> Dstarinvdiag<-1/vars$D.star
> Dstarnotsparse<-diag(vars$D.star)
> D.star.inv<-Diagonal(length(vars$u.star),Dstarinvdiag)
> vars$D.star<-Diagonal(length(vars$u.star),vars$D.star)
> 
> vars$family.glmm<-out$family.glmm
> 
> vars$ntrials<-1
> 
> beta.pql <- debug$beta.pql
> 
> simulate <- function(vars, Dstarnotsparse, m2, m3, beta.pql, D.star.inv){
+   #generate m1 from t(0,D*)
+   if(vars$m1>0) genData<-rmvt(ceiling(vars$m1/vars$no_cores),sigma=Dstarnotsparse,df=vars$zeta,type=c("shifted"))
+   if(vars$m1==0) genData<-NULL		
+   
+   #generate m2 from N(u*,D*)
+   if(m2>0) genData2<-genRand(vars$u.star,vars$D.star,ceiling(m2/vars$no_cores))
+   if(m2==0) genData2<-NULL
+   
+   
+   #generate m3 from N(u*,(Z'c''(Xbeta*+zu*)Z+D*^{-1})^-1)
+   if(m3>0){
+     Z=do.call(cbind,vars$mod.mcml$z)
+     eta.star<-as.vector(vars$mod.mcml$x%*%beta.pql+Z%*%vars$u.star)
+     if(vars$family.glmm$family.glmm=="bernoulli.glmm") {cdouble<-vars$family.glmm$cpp(eta.star)}
+     if(vars$family.glmm$family.glmm=="poisson.glmm"){cdouble<-vars$family.glmm$cpp(eta.star)}
+     if(vars$family.glmm$family.glmm=="binomial.glmm"){cdouble<-vars$family.glmm$cpp(eta.star, vars$ntrials)}
+     #still a vector
+     cdouble<-Diagonal(length(cdouble),cdouble)
+     Sigmuh.inv<- t(Z)%*%cdouble%*%Z+D.star.inv
+     Sigmuh<-solve(Sigmuh.inv)
+     genData3<-genRand(vars$u.star,Sigmuh,ceiling(m3/vars$no_cores))
+   }
+   if(m3==0) genData3<-NULL
+   
+   #	#these are from distribution based on data
+   #	if(distrib=="tee")genData<-genRand(sigma.gen,s.pql,mod.mcml$z,m1,distrib="tee",gamm)
+   #	if(distrib=="normal")genData<-genRand(sigma.pql,s.pql,mod.mcml$z,m1,distrib="normal",gamm)
+   #	#these are from standard normal
+   #	ones<-rep(1,length(sigma.pql))
+   #	zeros<-rep(0,length(s.pql))
+   #	genData2<-genRand(ones,zeros,mod.mcml$z,m2,distrib="normal",gamm)
+   
+   umat<-rbind(genData,genData2,genData3)
+   m <- nrow(umat)
+   list(umat=umat, m=m, Sigmuh.inv=Sigmuh.inv)
+ }
> 
> clusterSetRNGStream(vars$cl, 1234)
> 
> clusterExport(vars$cl, c("vars", "Dstarnotsparse", "m2", "m3", "beta.pql", "D.star.inv", "simulate", "genRand"), envir = environment())     #installing variables on each core
> clusterEvalQ(vars$cl, umatparams <- simulate(vars=vars, Dstarnotsparse=Dstarnotsparse, m2=m2, m3=m3, beta.pql=beta.pql, D.star.inv=D.star.inv))
[[1]]
[[1]]$umat
              [,1]        [,2]        [,3]        [,4]        [,5]         [,6]
 [1,] -0.080430052 -0.92993136  0.18169000  0.04383918  1.09640236 -0.099147820
 [2,] -1.938026615 -1.41074503  0.76022367 -0.61231144 -0.82732984 -2.150361049
 [3,] -0.275440766  0.55088074  1.27331105  1.14828239  0.81321724 -0.007735253
 [4,] -0.482828948  0.94109011 -1.53623229  0.86906377 -1.26399742 -0.604564343
 [5,] -0.176867736  1.14752701 -1.72439607  1.06639664  0.48793369 -0.151911280
 [6,]  1.382713063  0.15381095  0.63048260  0.47050546  0.93726337  0.622742255
 [7,] -0.398328563 -1.04605725 -1.24670370 -0.04130566  0.55679674 -0.219730035
 [8,] -0.014190594  2.79146681  0.04120076 -1.15849591  0.75186326  1.955782233
 [9,]  0.584560463  0.17403484  1.36480380 -0.73230113 -0.69072958 -0.866164839
[10,] -1.293819677 -0.40093865 -0.67671911  2.92217393 -1.04001241 -0.507246658
[11,]  0.505020487 -0.14290559  0.16632978  0.56429486 -1.38196944 -0.942968841
[12,] -1.220994840  0.83478414  0.35652332 -0.07325406  0.30869646 -0.579182636
[13,]  0.333095119 -1.07058570 -0.24420998 -0.61060639  0.18761548  1.026208715
[14,]  0.223998009  1.06158975 -0.80111820  1.26070182  1.05942449 -0.384883671
[15,] -0.224512069  0.48288230 -0.22537055  0.72204311  0.92511799  0.084875255
[16,] -1.019874182 -0.25978789 -0.10586182 -0.18094593  2.05383178 -1.720975343
[17,]  0.669475088  0.38301735 -0.90469467  1.64141951  0.29138519  2.506460910
[18,] -0.919196331 -0.48393544  0.18864890  2.16899875 -0.57341693  0.212844692
[19,]  0.489276598  0.21426774 -0.58595975 -0.26751591 -1.11042455  0.551162569
[20,] -1.924581033 -0.17563772  0.15678533  2.06839874  0.04932767 -0.258244021
[21,] -0.005257399  0.12003202  0.45032345 -0.56535954  0.09449962 -0.539236047
[22,]  0.490290955  0.08712523  0.31082070  0.01627887 -0.33346110  0.224602585
[23,]  0.449331411 -0.60015204  0.31840836 -0.27121523  0.01387721  0.049100778
[24,]  0.264947537  0.05074177  0.56230656  0.27183760  0.16608116 -0.337254725
[25,]  0.076141517 -0.11727009 -0.78030609 -0.14120489  0.25336521 -0.458736624
[26,]  0.113758627 -0.31265039  0.43360059 -0.19654820 -0.29638028  0.122966645
             [,7]        [,8]        [,9]       [,10]
 [1,]  0.11258678  1.25017365 -0.14222108  0.43052710
 [2,] -1.02239760  1.09525513 -2.92743516  0.25532809
 [3,] -1.25512569  0.43306470  0.24287138 -0.65417124
 [4,] -0.67316272 -0.05497524 -2.17740706  0.71051953
 [5,]  0.01440232 -0.79389403  1.55694268 -0.50675093
 [6,] -2.16997644  1.00805879  0.44790216  0.50036391
 [7,]  0.90946781 -0.59344467 -0.36857822  1.69487570
 [8,]  3.28403124  1.41589674 -0.14014063 -2.41185627
 [9,]  0.09630582 -1.71035591  1.23305643 -0.44782024
[10,]  0.77774925  1.66242339  1.53501429  0.73377362
[11,]  0.60515625  0.45931087  0.11074742 -0.56287284
[12,] -1.93821146  1.82375785  2.02532969 -1.53269329
[13,]  0.81124792 -0.66897527 -0.59685323 -1.17627835
[14,] -1.71606777 -1.78841483 -1.57955331 -0.53508854
[15,] -0.13018344  0.04176473  0.31306244 -2.01660522
[16,]  0.22433694 -1.70503654  1.49696569 -0.25567018
[17,]  0.42985569 -0.22552813  0.14481627  0.17168110
[18,] -0.55123930 -0.06267739  0.01762903 -1.43220427
[19,]  0.86931577 -0.21539829  0.29389132  0.53139232
[20,]  1.54277830  0.89341913 -0.30550576 -1.17997038
[21,]  0.40461112  0.16873322 -0.83226037 -1.03178261
[22,] -0.01965185  0.64748963  0.35022227  0.33693456
[23,]  0.86987652 -0.36452379 -0.49273983  0.26188544
[24,] -0.44575309 -0.10141838 -0.18477577 -0.12493103
[25,]  0.38885263  0.08204266 -0.32123899  0.34284037
[26,]  0.40974406 -0.03481506 -0.32574940  0.08952478

[[1]]$m
[1] 26

[[1]]$Sigmuh.inv
10 x 10 sparse Matrix of class "dgCMatrix"
   [[ suppressing 10 column names 'z11', 'z12', 'z13' ... ]]
                                                      
z11  4.75 .    .    .    .    .    .    .    .    .   
z12  .    4.75 .    .    .    .    .    .    .    .   
z13  .    .    4.75 .    .    .    .    .    .    .   
z14  .    .    .    4.75 .    .    .    .    .    .   
z15  .    .    .    .    4.75 .    .    .    .    .   
z16  .    .    .    .    .    4.75 .    .    .    .   
z17  .    .    .    .    .    .    4.75 .    .    .   
z18  .    .    .    .    .    .    .    4.75 .    .   
z19  .    .    .    .    .    .    .    .    4.75 .   
z110 .    .    .    .    .    .    .    .    .    4.75


[[2]]
[[2]]$umat
             [,1]        [,2]        [,3]        [,4]        [,5]         [,6]
 [1,] -0.19332953  1.00748222  0.09083020 -0.38165371 -1.42322030  0.001115757
 [2,] -0.94951901  0.08103662 -1.13987724  0.18096048  1.17056335 -1.525249197
 [3,] -0.26053479  0.78690695 -1.69829023 -1.75018915  0.43927687 -0.913897994
 [4,] -0.06232627 -0.01442118 -0.43471821 -0.33326599 -0.76068205 -0.609334667
 [5,]  1.93148888 -0.82610843  1.42105840  0.52045726  0.39681112 -0.786775292
 [6,] -0.19293995  2.76489862  1.69182847 -0.47263070  1.59165272  1.811598446
 [7,] -0.12519951  0.28375029 -1.37555289  0.33704357  0.48374437 -0.765277684
 [8,] -0.89416794  0.24919193  1.19267864  0.48554503  0.26305977 -0.495714317
 [9,]  0.27317816  0.11496344  0.52647266 -0.67247752  0.37387063 -0.579611950
[10,] -0.17968068  0.89521810  0.44052909  0.05205901 -0.89035208  0.941720358
[11,]  0.10566414 -1.14887464 -0.68211775 -1.25382724  0.40122880  0.799308819
[12,] -0.42852243  1.86055332  1.47988742  0.16748631 -0.22839809  0.277791932
[13,]  0.02492949 -1.17644448  1.14036389  2.28512706 -1.02570264  2.127530523
[14,] -0.27411446 -0.57388170  1.68973815 -0.80020552 -0.13566938  1.305879033
[15,] -0.31327050 -0.20579173  1.14431235  1.25686239 -1.03030180  1.494385785
[16,] -0.35780154 -1.55290054 -0.23351012  1.56946820 -0.10710520  1.063196843
[17,]  0.55719353  0.83841169 -0.50637583  1.30193046 -0.98574790  0.103626985
[18,]  1.04769344 -1.10279862  0.71867121 -0.19500984  1.14489445  0.546410302
[19,] -0.61293403  0.85112485  0.82242868  0.40031030 -1.03623247 -1.056336922
[20,] -0.36318213 -0.46408314  0.23744877 -0.47549996 -0.89933004  0.259350251
[21,] -0.16554792 -0.03999115 -0.25511474 -0.17649206  0.11380410  0.819865961
[22,] -0.11158500 -0.27402258 -0.87627273 -0.39812842 -0.19915596  0.356033084
[23,]  0.39537799  0.68964685 -0.51895176 -0.39771249 -0.25555045  0.265788960
[24,]  1.03415663  0.58853658 -0.07459787  0.30066437  0.34747208 -0.008380929
[25,] -0.14830466  0.21807610  0.74219350  0.34653436  0.03415010 -0.313968782
[26,] -0.27833310  0.35483858 -1.01021759 -0.47741516 -0.04157191 -0.407978805
             [,7]         [,8]        [,9]       [,10]
 [1,] -0.74669622 -0.596470627  1.18484724  0.07018304
 [2,]  0.11145074  2.507719616  1.11832247  0.80390810
 [3,] -0.53862610 -0.178853627 -0.46213364  0.17049174
 [4,] -0.83840536  0.369752553 -0.39035165 -2.37946865
 [5,] -0.20205208 -0.283232173  0.39724946  0.53128117
 [6,]  1.55522947 -4.062917764  0.61624559  1.51299201
 [7,] -2.41430523  1.450609825 -0.72745511  1.11472153
 [8,]  1.21757497 -1.956029594 -1.19447940  0.20468397
 [9,] -1.31708957  0.356871753  0.18974458  0.19278833
[10,]  0.41704712  1.186164554  0.45400249 -0.76360644
[11,]  0.38087854 -2.340581420 -0.05339559  0.69398683
[12,] -0.66589441  0.304060274  1.60507082  0.45630849
[13,] -0.28581867  0.953994957 -0.94587455  1.13636499
[14,] -1.05387134 -0.072719500 -1.24861143 -0.35276237
[15,] -0.28113312 -1.711288785 -0.71208989 -0.33446865
[16,] -0.75239468 -0.009961703 -0.71823546 -0.92204138
[17,]  1.40940131 -0.510906482 -0.48900589  1.20212487
[18,] -0.38641716 -1.102919045  0.07534050  0.76885912
[19,]  1.37333240  0.351440511 -1.71511359 -1.05261371
[20,]  0.39035775 -0.177079862 -1.24998658 -0.81426677
[21,]  0.73416481 -0.222998123  0.26968394  0.14806658
[22,] -0.33436913  0.175729936  0.38040977 -0.31767622
[23,]  0.02957769 -0.020381128 -0.16480255 -0.32412143
[24,]  0.25946024  0.901385566 -0.12332445  0.11335167
[25,]  0.36426394  0.437363085 -0.03264771  0.06927961
[26,]  1.46747124 -0.013422161 -0.18741037  0.26358022

[[2]]$m
[1] 26

[[2]]$Sigmuh.inv
10 x 10 sparse Matrix of class "dgCMatrix"
   [[ suppressing 10 column names 'z11', 'z12', 'z13' ... ]]
                                                      
z11  4.75 .    .    .    .    .    .    .    .    .   
z12  .    4.75 .    .    .    .    .    .    .    .   
z13  .    .    4.75 .    .    .    .    .    .    .   
z14  .    .    .    4.75 .    .    .    .    .    .   
z15  .    .    .    .    4.75 .    .    .    .    .   
z16  .    .    .    .    .    4.75 .    .    .    .   
z17  .    .    .    .    .    .    4.75 .    .    .   
z18  .    .    .    .    .    .    .    4.75 .    .   
z19  .    .    .    .    .    .    .    .    4.75 .   
z110 .    .    .    .    .    .    .    .    .    4.75


> 
> vars$nbeta <- 1
> 
> vars$p1=vars$p2=vars$p3=1/3
> 
> par<-c(6,1.5)
> del<-rep(10^-8,2)
> 
> objfun<-glmm:::objfun
> 
> core2<-objfun(par=par, vars=vars)
> 
> umats <- clusterEvalQ(vars$cl, umatparams$umat)
> umat <- Reduce(rbind, umats)
> 
> ms <- clusterEvalQ(vars$cl, umatparams$m)
> m <- ms[[1]]
> 
> Sigmuh.invs <- clusterEvalQ(vars$cl, umatparams$Sigmuh.inv)
> Sigmuh.inv <- Sigmuh.invs[[1]]
> 
> stopCluster(clust)
> 
> vars$cl <- makeCluster(1)
> 
> registerDoParallel(vars$cl)                   #making cluster usable with foreach
> vars$no_cores <- length(vars$cl)
> 
> clusterExport(vars$cl, c("umat", "m", "Sigmuh.inv"), envir = environment())
> clusterEvalQ(vars$cl, umatparams <- list(umat=umat, m=m, Sigmuh.inv=Sigmuh.inv))
[[1]]
[[1]]$umat
              [,1]        [,2]        [,3]        [,4]        [,5]         [,6]
 [1,] -0.080430052 -0.92993136  0.18169000  0.04383918  1.09640236 -0.099147820
 [2,] -1.938026615 -1.41074503  0.76022367 -0.61231144 -0.82732984 -2.150361049
 [3,] -0.275440766  0.55088074  1.27331105  1.14828239  0.81321724 -0.007735253
 [4,] -0.482828948  0.94109011 -1.53623229  0.86906377 -1.26399742 -0.604564343
 [5,] -0.176867736  1.14752701 -1.72439607  1.06639664  0.48793369 -0.151911280
 [6,]  1.382713063  0.15381095  0.63048260  0.47050546  0.93726337  0.622742255
 [7,] -0.398328563 -1.04605725 -1.24670370 -0.04130566  0.55679674 -0.219730035
 [8,] -0.014190594  2.79146681  0.04120076 -1.15849591  0.75186326  1.955782233
 [9,]  0.584560463  0.17403484  1.36480380 -0.73230113 -0.69072958 -0.866164839
[10,] -1.293819677 -0.40093865 -0.67671911  2.92217393 -1.04001241 -0.507246658
[11,]  0.505020487 -0.14290559  0.16632978  0.56429486 -1.38196944 -0.942968841
[12,] -1.220994840  0.83478414  0.35652332 -0.07325406  0.30869646 -0.579182636
[13,]  0.333095119 -1.07058570 -0.24420998 -0.61060639  0.18761548  1.026208715
[14,]  0.223998009  1.06158975 -0.80111820  1.26070182  1.05942449 -0.384883671
[15,] -0.224512069  0.48288230 -0.22537055  0.72204311  0.92511799  0.084875255
[16,] -1.019874182 -0.25978789 -0.10586182 -0.18094593  2.05383178 -1.720975343
[17,]  0.669475088  0.38301735 -0.90469467  1.64141951  0.29138519  2.506460910
[18,] -0.919196331 -0.48393544  0.18864890  2.16899875 -0.57341693  0.212844692
[19,]  0.489276598  0.21426774 -0.58595975 -0.26751591 -1.11042455  0.551162569
[20,] -1.924581033 -0.17563772  0.15678533  2.06839874  0.04932767 -0.258244021
[21,] -0.005257399  0.12003202  0.45032345 -0.56535954  0.09449962 -0.539236047
[22,]  0.490290955  0.08712523  0.31082070  0.01627887 -0.33346110  0.224602585
[23,]  0.449331411 -0.60015204  0.31840836 -0.27121523  0.01387721  0.049100778
[24,]  0.264947537  0.05074177  0.56230656  0.27183760  0.16608116 -0.337254725
[25,]  0.076141517 -0.11727009 -0.78030609 -0.14120489  0.25336521 -0.458736624
[26,]  0.113758627 -0.31265039  0.43360059 -0.19654820 -0.29638028  0.122966645
[27,] -0.193329531  1.00748222  0.09083020 -0.38165371 -1.42322030  0.001115757
[28,] -0.949519011  0.08103662 -1.13987724  0.18096048  1.17056335 -1.525249197
[29,] -0.260534792  0.78690695 -1.69829023 -1.75018915  0.43927687 -0.913897994
[30,] -0.062326271 -0.01442118 -0.43471821 -0.33326599 -0.76068205 -0.609334667
[31,]  1.931488884 -0.82610843  1.42105840  0.52045726  0.39681112 -0.786775292
[32,] -0.192939950  2.76489862  1.69182847 -0.47263070  1.59165272  1.811598446
[33,] -0.125199510  0.28375029 -1.37555289  0.33704357  0.48374437 -0.765277684
[34,] -0.894167940  0.24919193  1.19267864  0.48554503  0.26305977 -0.495714317
[35,]  0.273178162  0.11496344  0.52647266 -0.67247752  0.37387063 -0.579611950
[36,] -0.179680680  0.89521810  0.44052909  0.05205901 -0.89035208  0.941720358
[37,]  0.105664138 -1.14887464 -0.68211775 -1.25382724  0.40122880  0.799308819
[38,] -0.428522429  1.86055332  1.47988742  0.16748631 -0.22839809  0.277791932
[39,]  0.024929486 -1.17644448  1.14036389  2.28512706 -1.02570264  2.127530523
[40,] -0.274114460 -0.57388170  1.68973815 -0.80020552 -0.13566938  1.305879033
[41,] -0.313270502 -0.20579173  1.14431235  1.25686239 -1.03030180  1.494385785
[42,] -0.357801536 -1.55290054 -0.23351012  1.56946820 -0.10710520  1.063196843
[43,]  0.557193534  0.83841169 -0.50637583  1.30193046 -0.98574790  0.103626985
[44,]  1.047693442 -1.10279862  0.71867121 -0.19500984  1.14489445  0.546410302
[45,] -0.612934033  0.85112485  0.82242868  0.40031030 -1.03623247 -1.056336922
[46,] -0.363182133 -0.46408314  0.23744877 -0.47549996 -0.89933004  0.259350251
[47,] -0.165547925 -0.03999115 -0.25511474 -0.17649206  0.11380410  0.819865961
[48,] -0.111584995 -0.27402258 -0.87627273 -0.39812842 -0.19915596  0.356033084
[49,]  0.395377989  0.68964685 -0.51895176 -0.39771249 -0.25555045  0.265788960
[50,]  1.034156629  0.58853658 -0.07459787  0.30066437  0.34747208 -0.008380929
[51,] -0.148304660  0.21807610  0.74219350  0.34653436  0.03415010 -0.313968782
[52,] -0.278333100  0.35483858 -1.01021759 -0.47741516 -0.04157191 -0.407978805
             [,7]         [,8]        [,9]       [,10]
 [1,]  0.11258678  1.250173651 -0.14222108  0.43052710
 [2,] -1.02239760  1.095255133 -2.92743516  0.25532809
 [3,] -1.25512569  0.433064695  0.24287138 -0.65417124
 [4,] -0.67316272 -0.054975240 -2.17740706  0.71051953
 [5,]  0.01440232 -0.793894032  1.55694268 -0.50675093
 [6,] -2.16997644  1.008058788  0.44790216  0.50036391
 [7,]  0.90946781 -0.593444667 -0.36857822  1.69487570
 [8,]  3.28403124  1.415896740 -0.14014063 -2.41185627
 [9,]  0.09630582 -1.710355910  1.23305643 -0.44782024
[10,]  0.77774925  1.662423394  1.53501429  0.73377362
[11,]  0.60515625  0.459310867  0.11074742 -0.56287284
[12,] -1.93821146  1.823757846  2.02532969 -1.53269329
[13,]  0.81124792 -0.668975271 -0.59685323 -1.17627835
[14,] -1.71606777 -1.788414827 -1.57955331 -0.53508854
[15,] -0.13018344  0.041764732  0.31306244 -2.01660522
[16,]  0.22433694 -1.705036538  1.49696569 -0.25567018
[17,]  0.42985569 -0.225528127  0.14481627  0.17168110
[18,] -0.55123930 -0.062677390  0.01762903 -1.43220427
[19,]  0.86931577 -0.215398289  0.29389132  0.53139232
[20,]  1.54277830  0.893419126 -0.30550576 -1.17997038
[21,]  0.40461112  0.168733224 -0.83226037 -1.03178261
[22,] -0.01965185  0.647489627  0.35022227  0.33693456
[23,]  0.86987652 -0.364523793 -0.49273983  0.26188544
[24,] -0.44575309 -0.101418376 -0.18477577 -0.12493103
[25,]  0.38885263  0.082042658 -0.32123899  0.34284037
[26,]  0.40974406 -0.034815059 -0.32574940  0.08952478
[27,] -0.74669622 -0.596470627  1.18484724  0.07018304
[28,]  0.11145074  2.507719616  1.11832247  0.80390810
[29,] -0.53862610 -0.178853627 -0.46213364  0.17049174
[30,] -0.83840536  0.369752553 -0.39035165 -2.37946865
[31,] -0.20205208 -0.283232173  0.39724946  0.53128117
[32,]  1.55522947 -4.062917764  0.61624559  1.51299201
[33,] -2.41430523  1.450609825 -0.72745511  1.11472153
[34,]  1.21757497 -1.956029594 -1.19447940  0.20468397
[35,] -1.31708957  0.356871753  0.18974458  0.19278833
[36,]  0.41704712  1.186164554  0.45400249 -0.76360644
[37,]  0.38087854 -2.340581420 -0.05339559  0.69398683
[38,] -0.66589441  0.304060274  1.60507082  0.45630849
[39,] -0.28581867  0.953994957 -0.94587455  1.13636499
[40,] -1.05387134 -0.072719500 -1.24861143 -0.35276237
[41,] -0.28113312 -1.711288785 -0.71208989 -0.33446865
[42,] -0.75239468 -0.009961703 -0.71823546 -0.92204138
[43,]  1.40940131 -0.510906482 -0.48900589  1.20212487
[44,] -0.38641716 -1.102919045  0.07534050  0.76885912
[45,]  1.37333240  0.351440511 -1.71511359 -1.05261371
[46,]  0.39035775 -0.177079862 -1.24998658 -0.81426677
[47,]  0.73416481 -0.222998123  0.26968394  0.14806658
[48,] -0.33436913  0.175729936  0.38040977 -0.31767622
[49,]  0.02957769 -0.020381128 -0.16480255 -0.32412143
[50,]  0.25946024  0.901385566 -0.12332445  0.11335167
[51,]  0.36426394  0.437363085 -0.03264771  0.06927961
[52,]  1.46747124 -0.013422161 -0.18741037  0.26358022

[[1]]$m
[1] 26

[[1]]$Sigmuh.inv
10 x 10 sparse Matrix of class "dgCMatrix"
   [[ suppressing 10 column names 'z11', 'z12', 'z13' ... ]]
                                                      
z11  4.75 .    .    .    .    .    .    .    .    .   
z12  .    4.75 .    .    .    .    .    .    .    .   
z13  .    .    4.75 .    .    .    .    .    .    .   
z14  .    .    .    4.75 .    .    .    .    .    .   
z15  .    .    .    .    4.75 .    .    .    .    .   
z16  .    .    .    .    .    4.75 .    .    .    .   
z17  .    .    .    .    .    .    4.75 .    .    .   
z18  .    .    .    .    .    .    .    4.75 .    .   
z19  .    .    .    .    .    .    .    .    4.75 .   
z110 .    .    .    .    .    .    .    .    .    4.75


> 
> core1<-objfun(par=par, vars=vars)
> 
> all.equal(core1, core2)
[1] "Component \"value\": Mean relative difference: 0.01973503"  
[2] "Component \"gradient\": Mean relative difference: 0.9852206"
[3] "Component \"hessian\": Mean relative difference: 0.7350254" 
> 
> stopCluster(vars$cl)
> 
> proc.time()
   user  system elapsed 
 14.617   0.827  21.507 
